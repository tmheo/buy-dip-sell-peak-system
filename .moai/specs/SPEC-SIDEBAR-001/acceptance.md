---
spec_id: SPEC-SIDEBAR-001
title: SOXL 가격 사이드바 수락 기준
version: "1.0.0"
created: "2026-01-16"
updated: "2026-01-16"
author: "허태명"
---

# SPEC-SIDEBAR-001: 수락 기준

## 1. 테스트 시나리오

### TC-001: 최근 가격 데이터 조회

**Given** 데이터베이스에 SOXL 가격 데이터가 20일 이상 존재할 때
**When** `getLatestPrices(11, 'SOXL')`을 호출하면
**Then** 최근 11일치의 가격 데이터가 날짜 내림차순으로 반환된다

**검증 항목:**
- [ ] 반환 배열 길이가 11개
- [ ] 첫 번째 항목이 가장 최근 날짜
- [ ] 각 항목에 `date`, `close` 필드 존재

---

### TC-002: 일별 변동률 계산 정확성

**Given** 다음 가격 데이터가 주어졌을 때:
```
1/15: $28.45
1/14: $27.81
```

**When** 변동률을 계산하면
**Then** 1/15의 변동률은 `((28.45 - 27.81) / 27.81) × 100 = 2.30%`이다

**검증 항목:**
- [ ] 변동률 계산 공식 정확성
- [ ] 소수점 첫째 자리까지 표시
- [ ] 양수일 때 `+` 기호 표시

---

### TC-003: 상승/하락 색상 표시

**Given** 사이드바가 렌더링될 때

**Scenario 3.1: 상승 (change >= 0)**
**When** 변동률이 0 이상이면
**Then** 해당 셀에 `price-up` 클래스가 적용된다
**And** 텍스트 색상이 `#ff5370`(빨간색)이다

**Scenario 3.2: 하락 (change < 0)**
**When** 변동률이 0 미만이면
**Then** 해당 셀에 `price-down` 클래스가 적용된다
**And** 텍스트 색상이 `#26c6da`(청록색)이다

**검증 항목:**
- [ ] 상승 시 `price-up` 클래스 적용
- [ ] 하락 시 `price-down` 클래스 적용
- [ ] CSS 변수가 올바르게 정의됨

---

### TC-004: Server Component 유지

**Given** `src/components/Sidebar.tsx` 파일
**When** 파일 내용을 검사하면
**Then** `'use client'` 지시어가 없다
**And** 데이터베이스 모듈을 직접 import 한다

**검증 항목:**
- [ ] `'use client'` 지시어 부재
- [ ] `import ... from '@/database/index.js'` 또는 상대 경로 import 존재
- [ ] 비동기 함수가 아닌 동기 함수 사용

---

### TC-005: 데이터 정렬 확인

**Given** 사이드바에 10일치 데이터가 표시될 때
**When** 테이블 행을 순서대로 확인하면
**Then** 첫 번째 행이 가장 최근 날짜이다
**And** 이후 행은 날짜가 감소하는 순서이다

**검증 항목:**
- [ ] 첫 번째 행 날짜 > 두 번째 행 날짜
- [ ] 모든 행이 내림차순 정렬

---

### TC-006: 데이터 부족 시 처리

**Given** 데이터베이스에 SOXL 데이터가 5일치만 존재할 때
**When** 사이드바가 렌더링되면
**Then** 5일치 데이터만 표시된다
**And** 에러가 발생하지 않는다

**검증 항목:**
- [ ] 존재하는 데이터만 표시
- [ ] 빈 행이나 에러 메시지 없음
- [ ] 정상적인 레이아웃 유지

---

## 2. UI 검증 체크리스트

### 2.1 테이블 구조

| 항목 | 기대값 | 확인 |
|------|--------|------|
| 컬럼 수 | 3개 (날짜, 종가, 변동) | [ ] |
| 행 수 | 최대 10개 | [ ] |
| 헤더 텍스트 | 날짜, 종가, 변동 | [ ] |

### 2.2 데이터 포맷

| 항목 | 기대 포맷 | 예시 | 확인 |
|------|----------|------|------|
| 날짜 | YYYY-MM-DD | 2026-01-15 | [ ] |
| 종가 | $XX.XX | $28.45 | [ ] |
| 변동률 | ±X.X% | +2.3% | [ ] |

### 2.3 스타일

| 항목 | 기대값 | 확인 |
|------|--------|------|
| 카드 헤더 | "최근 주가 (SOXL)" | [ ] |
| 테이블 클래스 | `table-dark table-striped table-hover` | [ ] |
| 상승 색상 | #ff5370 (빨간색) | [ ] |
| 하락 색상 | #26c6da (청록색) | [ ] |

---

## 3. 통합 테스트

### 3.1 페이지별 사이드바 동작

| 페이지 | URL | 사이드바 표시 | 확인 |
|--------|-----|--------------|------|
| 메인 | `/` | 표시됨 | [ ] |
| 정보 | `/info` | 표시됨 | [ ] |
| 백테스트 | `/backtest` | 표시됨 | [ ] |

### 3.2 데이터 일관성

**Given** 메인 페이지와 정보 페이지를 동시에 열었을 때
**When** 사이드바 데이터를 비교하면
**Then** 동일한 데이터가 표시된다

---

## 4. 에러 처리

### 4.1 데이터베이스 연결 실패

**Given** 데이터베이스 파일이 존재하지 않을 때
**When** 사이드바가 렌더링되면
**Then** 에러가 콘솔에 기록된다
**And** 빈 사이드바 또는 "데이터 없음" 메시지가 표시된다
**And** 페이지가 크래시하지 않는다

### 4.2 빈 데이터베이스

**Given** 데이터베이스가 존재하지만 SOXL 데이터가 없을 때
**When** 사이드바가 렌더링되면
**Then** 빈 테이블 또는 "데이터 없음" 메시지가 표시된다
**And** 에러가 발생하지 않는다

---

## 5. Definition of Done

### 5.1 기능 완료 조건

- [ ] `getLatestPrices()` 함수가 구현되고 export 됨
- [ ] 사이드바가 실제 데이터베이스 데이터를 표시함
- [ ] 변동률이 정확하게 계산됨
- [ ] 색상 코딩이 올바르게 적용됨
- [ ] 모든 페이지에서 사이드바가 정상 동작함

### 5.2 코드 품질 조건

- [ ] TypeScript 타입 검사 통과 (`npm run build` 성공)
- [ ] ESLint 검사 통과 (`npm run lint` 에러 없음)
- [ ] Server Component로 유지 (`'use client'` 없음)

### 5.3 문서화 조건

- [ ] 코드 내 주석으로 변동률 계산 로직 설명
- [ ] SPEC 문서와 구현 코드 일치

---

## 6. 수동 테스트 절차

### 6.1 사전 준비

```bash
# 1. 데이터베이스 확인
ls -la data/prices.db

# 2. 개발 서버 시작
npm run web:dev
```

### 6.2 테스트 실행

1. 브라우저에서 `http://localhost:3000` 접속
2. 우측 사이드바 확인
3. 다음 항목 검증:
   - 10일치 데이터 표시 여부
   - 날짜 포맷 (YYYY-MM-DD)
   - 종가 포맷 ($XX.XX)
   - 변동률 포맷 (±X.X%)
   - 상승/하락 색상

4. `/info`, `/backtest` 페이지에서도 동일하게 검증

### 6.3 결과 기록

| 테스트 항목 | 예상 결과 | 실제 결과 | Pass/Fail |
|-------------|----------|----------|-----------|
| 데이터 표시 | 10일치 | | |
| 날짜 포맷 | YYYY-MM-DD | | |
| 종가 포맷 | $XX.XX | | |
| 변동률 포맷 | ±X.X% | | |
| 상승 색상 | #ff5370 | | |
| 하락 색상 | #26c6da | | |
